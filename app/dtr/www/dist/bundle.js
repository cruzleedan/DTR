/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./www/js/fileHelper.js":
/*!******************************!*\
  !*** ./www/js/fileHelper.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"saveFile\": () => (/* binding */ saveFile)\n/* harmony export */ });\nconst writeFile = function (fileEntry, dataObj) {\r\n    // Create a FileWriter object for our FileEntry (log.txt).\r\n    fileEntry.createWriter(function (fileWriter) {\r\n\r\n        fileWriter.onwriteend = function() {\r\n            console.log(\"Successful file write...\");\r\n        };\r\n\r\n        fileWriter.onerror = function (e) {\r\n            console.log(\"Failed file write: \" + e.toString());\r\n        };\r\n\r\n        // If data object is not passed in,\r\n        // create a new Blob instead.\r\n        if (!dataObj) {\r\n            dataObj = new Blob(['some file data'], { type: 'text/plain' });\r\n        }\r\n\r\n        fileWriter.write(dataObj);\r\n    });\r\n};\r\n\r\nconst cordovaSaveFile = (data, filename) => {\r\n    window.requestFileSystem(\r\n        LocalFileSystem.PERSISTENT,\r\n        0,\r\n        function (fileSystem) {\r\n            fileSystem.root.getDirectory(\r\n                \"Download\",\r\n                { create: true, exclusive: false },\r\n                function (dirEntry) {\r\n                    dirEntry.getFile(\r\n                        filename,\r\n                        { create: true, exclusive: false },\r\n                        function (fileEntry) {\r\n                            writeFile(fileEntry, data);\r\n                        },\r\n                        function (error) {\r\n                            console.log(\r\n                                \"error downloading file \", error\r\n                            );\r\n                        }\r\n                    );\r\n                },\r\n                function (error) {\r\n                    console.log(\"creating file \", error);\r\n                }\r\n            );\r\n        },\r\n        function (error) {\r\n            console.log(\"error accessing local file system\", error);\r\n        }\r\n    );\r\n};\r\nconst saveFile = (data, filename) => {\r\n    if (device.platform === \"Android\") {\r\n        cordovaSaveFile(data, filename);\r\n    } else {\r\n        saveAs(data, filename);\r\n    }\r\n};\r\n\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/fileHelper.js?");

/***/ }),

/***/ "./www/js/fileReader.js":
/*!******************************!*\
  !*** ./www/js/fileReader.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"process_wb\": () => (/* binding */ process_wb),\n/* harmony export */   \"readFile\": () => (/* binding */ readFile)\n/* harmony export */ });\n/* harmony import */ var _tableGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tableGenerator.js */ \"./www/js/tableGenerator.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"./www/js/utils.js\");\n/* harmony import */ var _globalVars__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./globalVars */ \"./www/js/globalVars.js\");\n\r\n\r\n\r\n\r\nvar XW = {\r\n\t/* worker message */\r\n\tmsg: 'xlsx',\r\n\t/* worker scripts */\r\n\tworker: './js/workers/xlsxworker.js'\r\n};\r\n\r\nconst getTimeCol = (hours, arr) => {\r\n    let index;\r\n    if (hours > 5 && hours < 11) {\r\n        index = 0;\r\n    } else if (hours > 11 && hours < 14) {\r\n        index = 2;\r\n        if (!arr[1]) {\r\n            index = 1;\r\n        }\r\n    } else if (hours > 14) {\r\n        index = 3;\r\n    }\r\n    return index;\r\n}\r\n\r\nconst transformData = (arr) => {\r\n    let data = new Map();\r\n    let columns = {};\r\n    let minDate;\r\n    let maxDate;\r\n    for(let i = 0; i < arr.length; i++) {\r\n        let row = arr[i][0];\r\n        row = row.split('\\t').map(col => col.trim());\r\n        if (i === 0) {\r\n            row.forEach((name, j) => columns[name] = j);\r\n            continue;\r\n        }\r\n        let datetime = new Date(row[columns.DateTime]);\r\n        let dateStr = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getDateStringFromDatetime)(datetime);\r\n        let name = row[columns.Name].trim() || row[columns.UID].trim();\r\n        let time = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getTimeFromDatetime)(datetime);\r\n\r\n        if (!minDate || (new Date(dateStr) - new Date(minDate) < 0)) {\r\n            minDate = dateStr;\r\n        }\r\n        if (!maxDate || (new Date(dateStr) - new Date(maxDate) > 0)) {\r\n            maxDate = dateStr;\r\n        }\r\n        \r\n        if (!data.has(name)) {\r\n            data.set(name, {\r\n                [dateStr]: ['', '', '', '']\r\n            });\r\n        }\r\n        \r\n        if (!data.get(name)[dateStr]) {\r\n            data.get(name)[dateStr] = ['', '', '', ''] // 2 Logs for AM and 2 Logs for PM\r\n        }\r\n\r\n        let momentDate = moment(datetime);\r\n        let hours = momentDate.hours();\r\n        let index = getTimeCol(hours, data.get(name)[dateStr]);\r\n        let lastLog = data.get(name)[dateStr][index];\r\n        if (lastLog) {\r\n            let diffMin = momentDate.diff(lastLog, 'minutes');\r\n            if (diffMin > 5) {\r\n                data.get(name)[dateStr][index] = datetime;\r\n            }\r\n        } else {\r\n            data.get(name)[dateStr][index] = datetime;\r\n        }\r\n    }\r\n\r\n    let period = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getDatesBetweenDates)(new Date(minDate), new Date(maxDate));\r\n    for (let i = 0; i < period.length; i++) {\r\n        let date = period[i];\r\n        let dayOfWeek = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getDayOfTheWeek)(date);\r\n        data.forEach((row) => {\r\n            if (row[date]) {\r\n                let totalHours;\r\n                let totalMinutes;\r\n                if ((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isDateInstance)([\r\n                    row[date][0],\r\n                    row[date][1],\r\n                    row[date][2],\r\n                    row[date][3]\r\n                ])) {\r\n                    let morningDuration = moment.duration(moment(row[date][1]).diff(row[date][0]));\r\n                    let afternoonDuration = moment.duration(moment(row[date][3]).diff(row[date][2]));\r\n                    totalHours = parseInt(morningDuration.asHours() + afternoonDuration.asHours());\r\n                    totalMinutes = parseInt((morningDuration.asMinutes() + afternoonDuration.asMinutes()) % 60);\r\n                } else if ((0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isDateInstance)([\r\n                    row[date][0],\r\n                    row[date][3]\r\n                ]) && (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.isNotDateInstance)([\r\n                    row[date][1],\r\n                    row[date][2],\r\n                ])) {\r\n                    let duration = moment.duration(moment(row[date][3]).diff(row[date][0]));\r\n                    totalHours = parseInt(duration.asHours());\r\n                    totalMinutes = parseInt(duration.asMinutes() % 60);\r\n                }\r\n                \r\n                row[date] = row[date].map(datetime => datetime instanceof Date ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getTimeFromDatetime)(datetime) : datetime);\r\n                row[date].unshift(date, dayOfWeek);\r\n                row[date].push(totalHours, totalMinutes);\r\n            } else {\r\n                row[date] = [date, dayOfWeek];\r\n            }\r\n        });\r\n    }\r\n\r\n    let timesheet = [];\r\n    data.forEach((row, name) => {\r\n        timesheet = timesheet.concat([[name]], Object.values(row));\r\n    });\r\n    \r\n    return {\r\n        data,\r\n        minDate,\r\n        maxDate,\r\n        timesheet\r\n    };\r\n}\r\n\r\nconst process_wb = (function() {\r\n\tvar OUT = document.getElementById('out');\r\n\tvar HTMLOUT = document.getElementById('htmlout');\r\n\r\n\tvar get_format = (function() {\r\n\t\tvar radios = document.getElementsByName( \"format\" );\r\n\t\treturn function() {\r\n\t\t\tfor(var i = 0; i < radios.length; ++i) if(radios[i].checked || radios.length === 1) return radios[i].value;\r\n\t\t};\r\n\t})();\r\n\r\n\tvar to_table = function to_json(workbook) {\r\n\t\tvar result = {};\r\n\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\tvar roa = _globalVars__WEBPACK_IMPORTED_MODULE_2__.X.utils.sheet_to_json(workbook.Sheets[sheetName], {header:1});\r\n\t\t\tif(roa.length) result[sheetName] = roa;\r\n\t\t});\r\n        let { timesheet, minDate, maxDate } = transformData(result.Sheet1);\r\n        let table = (0,_tableGenerator_js__WEBPACK_IMPORTED_MODULE_0__.createTable)(timesheet, `${minDate}_${maxDate}`);\r\n        HTMLOUT.innerHTML = \"\";\r\n        HTMLOUT.appendChild(table);\r\n        return \"\";\r\n\t};\r\n\t\r\n    var to_json = function to_json(workbook) {\r\n\t\tvar result = {};\r\n\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\tvar roa = _globalVars__WEBPACK_IMPORTED_MODULE_2__.X.utils.sheet_to_json(workbook.Sheets[sheetName], {header:1});\r\n\t\t\tif(roa.length) result[sheetName] = roa;\r\n\t\t});\r\n        return JSON.stringify(result, 2, 2);\r\n\t};\r\n\r\n\tvar to_csv = function to_csv(workbook) {\r\n\t\tvar result = [];\r\n\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\tvar csv = _globalVars__WEBPACK_IMPORTED_MODULE_2__.X.utils.sheet_to_csv(workbook.Sheets[sheetName]);\r\n\t\t\tif(csv.length){\r\n\t\t\t\tresult.push(\"SHEET: \" + sheetName);\r\n\t\t\t\tresult.push(\"\");\r\n\t\t\t\tresult.push(csv);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result.join(\"\\n\");\r\n\t};\r\n\r\n\tvar to_fmla = function to_fmla(workbook) {\r\n\t\tvar result = [];\r\n\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\tvar formulae = _globalVars__WEBPACK_IMPORTED_MODULE_2__.X.utils.get_formulae(workbook.Sheets[sheetName]);\r\n\t\t\tif(formulae.length){\r\n\t\t\t\tresult.push(\"SHEET: \" + sheetName);\r\n\t\t\t\tresult.push(\"\");\r\n\t\t\t\tresult.push(formulae.join(\"\\n\"));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result.join(\"\\n\");\r\n\t};\r\n\r\n\tvar to_html = function to_html(workbook) {\r\n\t\tHTMLOUT.innerHTML = \"\";\r\n\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\tvar htmlstr = _globalVars__WEBPACK_IMPORTED_MODULE_2__.X.write(workbook, {sheet:sheetName, type:'string', bookType:'html'});\r\n\t\t\tHTMLOUT.innerHTML += htmlstr;\r\n\t\t});\r\n\t\treturn \"\";\r\n\t};\r\n\r\n\treturn function process_wb(wb) {\r\n        (0,_globalVars__WEBPACK_IMPORTED_MODULE_2__.setGlobalVar)('global_wb', wb);\r\n\t\t// global_wb = wb;\r\n\t\tvar output = \"\";\r\n\r\n        HTMLOUT.innerHTML = \"\";\r\n        OUT.innerHTML = \"\";\r\n\r\n\t\tswitch(get_format()) {\r\n\t\t\tcase \"form\":\r\n                output = to_fmla(wb); break;\r\n\t\t\tcase \"html\":\r\n                output = to_html(wb); break;\r\n\t\t\tcase \"json\":\r\n                output = to_json(wb); break;\r\n\t\t\tcase \"table\":\r\n                output = to_table(wb); break;\r\n\t\t\tdefault:\r\n                output = to_csv(wb);\r\n\t\t}\r\n\t\t\r\n        if (OUT.innerText === undefined) {\r\n            OUT.textContent = output;\r\n        } else {\r\n            OUT.innerText = output;\r\n        }\r\n\r\n\t\tif (typeof console !== 'undefined') {\r\n            console.log(\"output\", new Date());\r\n        }\r\n\t};\r\n})(_globalVars__WEBPACK_IMPORTED_MODULE_2__.global_wb, _globalVars__WEBPACK_IMPORTED_MODULE_2__.X);\r\n\r\nconst readFile = (() => {\r\n    var rABS = typeof FileReader !== \"undefined\" && (FileReader.prototype||{}).readAsBinaryString;\r\n    var domrabs = document.getElementsByName(\"userabs\")[0];\r\n    if (!rABS) {\r\n        domrabs.disabled = !(domrabs.checked = false);\r\n    }\r\n\r\n    var use_worker = typeof Worker !== 'undefined';\r\n    var domwork = document.getElementsByName(\"useworker\")[0];\r\n    if (!use_worker) {\r\n        domwork.disabled = !(domwork.checked = false);\r\n    }\r\n\r\n    var xw = function xw(data, cb) {\r\n        var worker = new Worker(XW.worker);\r\n        worker.onmessage = function(e) {\r\n            switch(e.data.t) {\r\n                case 'ready': break;\r\n                case 'e': console.error(e.data.d); break;\r\n                case XW.msg: cb(JSON.parse(e.data.d)); break;\r\n            }\r\n        };\r\n        worker.postMessage({d:data,b:rABS?'binary':'array'});\r\n    };\r\n\r\n    return function do_file(files, callbackFn) {\r\n        rABS = domrabs.checked;\r\n        use_worker = domwork.checked;\r\n        var file = files[0];\r\n        var reader = new FileReader();\r\n        reader.onload = function(e) {\r\n            if (typeof console !== 'undefined') {\r\n                console.log(\"onload\", new Date(), rABS, use_worker);\r\n            }\r\n\r\n            var data = e.target.result;\r\n            if (!rABS) {\r\n                data = new Uint8Array(data);\r\n            }\r\n\r\n            if (use_worker) {\r\n                xw(data, process_wb);\r\n            } else {\r\n                process_wb(_globalVars__WEBPACK_IMPORTED_MODULE_2__.X.read(data, {type: rABS ? 'binary' : 'array'}));\r\n            }\r\n        };\r\n\r\n        if (rABS) {\r\n            reader.readAsBinaryString(file);\r\n        } else {\r\n            reader.readAsArrayBuffer(file);\r\n        }\r\n    };    \r\n})(_globalVars__WEBPACK_IMPORTED_MODULE_2__.X);\r\n\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/fileReader.js?");

/***/ }),

/***/ "./www/js/globalVars.js":
/*!******************************!*\
  !*** ./www/js/globalVars.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"X\": () => (/* binding */ X),\n/* harmony export */   \"global_wb\": () => (/* binding */ global_wb),\n/* harmony export */   \"setGlobalVar\": () => (/* binding */ setGlobalVar)\n/* harmony export */ });\nvar X = null;\r\nvar global_wb = null;\r\nvar setGlobalVar = (name, value) => {\r\n    switch (name) {\r\n        case 'X':\r\n            X = value;\r\n            break;\r\n        case 'global_wb':\r\n            global_wb = value;\r\n            break;\r\n        default:\r\n    }\r\n}\r\n\r\n\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/globalVars.js?");

/***/ }),

/***/ "./www/js/index.js":
/*!*************************!*\
  !*** ./www/js/index.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _main_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./main.js */ \"./www/js/main.js\");\n/* harmony import */ var _globalVars__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./globalVars */ \"./www/js/globalVars.js\");\n/*\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\n\r\n// Wait for the deviceready event before using any of Cordova's device APIs.\r\n// See https://cordova.apache.org/docs/en/latest/cordova/events/events.html#deviceready\r\n\r\n\r\n\r\n\r\ndocument.addEventListener('deviceready', onDeviceReady, false);\r\n\r\nfunction onDeviceReady() {\r\n    // Cordova is now initialized. Have fun!\r\n\r\n    console.log('Running cordova-' + cordova.platformId + '@' + cordova.version);\r\n    document.getElementById('deviceready').classList.add('ready');\r\n    document.getElementById('main-loading-mask').classList.add('hidden');\r\n    (0,_globalVars__WEBPACK_IMPORTED_MODULE_1__.setGlobalVar)('X', XLSX);\r\n    (0,_main_js__WEBPACK_IMPORTED_MODULE_0__.initializeApp)();\r\n}\r\n\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/index.js?");

/***/ }),

/***/ "./www/js/main.js":
/*!************************!*\
  !*** ./www/js/main.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"initializeApp\": () => (/* binding */ initializeApp)\n/* harmony export */ });\n/* harmony import */ var _fileReader_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fileReader.js */ \"./www/js/fileReader.js\");\n/* harmony import */ var _globalVars__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./globalVars */ \"./www/js/globalVars.js\");\n\r\n\r\n\r\nconst onChangeUploadFile = (e) => {\r\n    (0,_fileReader_js__WEBPACK_IMPORTED_MODULE_0__.readFile)(e.target.files);\r\n}\r\n\r\nconst onClickUploadXlsFile = () => {\r\n    const upload = document.querySelector(\".upload-file-input\");\r\n    upload.click();\r\n    upload.addEventListener(\"change\", onChangeUploadFile);\r\n};\r\n\r\nconst onChangeFormat = window.setfmt = function setfmt() {\r\n    if (_globalVars__WEBPACK_IMPORTED_MODULE_1__.global_wb) {\r\n        (0,_fileReader_js__WEBPACK_IMPORTED_MODULE_0__.process_wb)(_globalVars__WEBPACK_IMPORTED_MODULE_1__.global_wb);\r\n    }\r\n};\r\n\r\nconst onToggleSettings = () => {\r\n    const settings = document.querySelector('#advance-settings');\r\n    const isCollapsed = settings.classList.contains(\"collapsed\");\r\n    if (isCollapsed) {\r\n        settings.classList.remove(\"collapsed\");\r\n    } else {\r\n        settings.classList.add(\"collapsed\");\r\n    }\r\n};\r\n\r\nconst setupDragAndDrop = () => {\r\n    const dropArea = document.querySelector('#drop-area');\r\n    const handleDrop = (e) => {\r\n        let dt = e.dataTransfer;\r\n        let files = dt.files;\r\n\r\n        (0,_fileReader_js__WEBPACK_IMPORTED_MODULE_0__.readFile)(files);\r\n    }\r\n      \r\n    const highlight = (e) => {\r\n        dropArea.classList.add('highlight')\r\n    }\r\n      \r\n    const unhighlight = (e) => {\r\n        dropArea.classList.remove('highlight')\r\n    }\r\n\r\n    const preventDefaults = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    }\r\n\r\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, preventDefaults, false)\r\n    });\r\n\r\n    ['dragenter', 'dragover'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, highlight, false)\r\n    });\r\n      \r\n    ['dragleave', 'drop'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, unhighlight, false)\r\n    });\r\n\r\n    dropArea.addEventListener('drop', handleDrop, false);  \r\n};\r\n\r\nconst initializeApp = () => {\r\n    const uploadBtn = document.querySelector('.upload-file-btn');\r\n    const outputFormat = document.querySelector('select[name=format]');\r\n    const settingsBtn = document.querySelector('#advance-settings-btn');\r\n\r\n    uploadBtn.addEventListener('click', onClickUploadXlsFile);\r\n    outputFormat.addEventListener('change', onChangeFormat);\r\n    settingsBtn.addEventListener('click', onToggleSettings);\r\n    \r\n    setupDragAndDrop();\r\n};\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/main.js?");

/***/ }),

/***/ "./www/js/tableGenerator.js":
/*!**********************************!*\
  !*** ./www/js/tableGenerator.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"createTable\": () => (/* binding */ createTable)\n/* harmony export */ });\n/* harmony import */ var _fileHelper_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fileHelper.js */ \"./www/js/fileHelper.js\");\n\r\nconst exportTableToXlsx = (tableEl, filename = 'dtr') => {\r\n    const wb = XLSX.utils.table_to_book(tableEl, { sheet: \"DTR\" });\r\n    wb.Props = {\r\n        Title: \"DTR\",\r\n        Subject: \"Time Period\",\r\n        Author: \"D3\",\r\n        CreatedDate: new Date()\r\n    };\r\n    \r\n    let wbout = XLSX.write(wb, { bookType:'xlsx',  type: 'binary' });\r\n    \r\n    function s2ab(s) {\r\n        let buf = new ArrayBuffer(s.length);\r\n        let view = new Uint8Array(buf);\r\n        for (var i=0; i<s.length; i++) {\r\n            view[i] = s.charCodeAt(i) & 0xFF;\r\n        }\r\n        return buf;\r\n    }\r\n    const fullFilename = filename.replace(/\\//g, '-');\r\n    (0,_fileHelper_js__WEBPACK_IMPORTED_MODULE_0__.saveFile)(new Blob([s2ab(wbout)],{type:\"application/octet-stream\"}), `${filename}.xlsx`);\r\n};\r\n\r\nconst onCellKedown = (e, cell) => {\r\n    let row = cell.parentNode;\r\n    if ((e.ctrlKey || e.metaKey) && e.key === \"Backspace\") {\r\n        if (!cell.innerText) {\r\n            cell.remove();\r\n            if (row.querySelectorAll(\"td:not(.add-col-cont)\").length === 0) {\r\n                row.remove();\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nconst createEditableCell = () => {\r\n    const tdEl = document.createElement(\"td\");\r\n    tdEl.contentEditable = true;\r\n    tdEl.addEventListener(\"keydown\", (e) => onCellKedown(e, tdEl));\r\n    return tdEl;\r\n};\r\n\r\nconst onAddCol = (addCol, trEl) => {\r\n    const tdEl = createEditableCell();\r\n    trEl.insertBefore(tdEl, addCol);\r\n};\r\n\r\nconst onAddRow = (row) => {\r\n    const trEl = document.createElement(\"tr\");\r\n    const tdEl = createEditableCell();\r\n    trEl.classList.add(\"relative-pos\");\r\n    trEl.appendChild(createAddRow());\r\n    trEl.appendChild(tdEl);\r\n    trEl.appendChild(createAddCol(trEl));\r\n    row.parentNode.insertBefore(trEl, row.nextSibling);\r\n};\r\n\r\nconst createAddBtn = (cls) => {\r\n    const div = document.createElement(\"div\");\r\n    div.classList.add(cls);\r\n    return div;\r\n};\r\n\r\nconst createAddCol = (trEl) => {\r\n    const addCol = document.createElement(\"td\");\r\n    const addColBtn = createAddBtn(\"add-col-btn\");\r\n    addCol.classList.add(\"add-col-cont\", \"no-border\");\r\n    addCol.appendChild(addColBtn);\r\n    addColBtn.addEventListener(\"click\", () => onAddCol(addCol, trEl));\r\n    return addCol;\r\n};\r\n\r\nconst createAddRow = (trEl) => {\r\n    const addRowBtn = createAddBtn(\"add-row-btn\");\r\n    addRowBtn.addEventListener(\"click\", () => onAddRow(trEl));\r\n    return addRowBtn;\r\n};\r\n\r\nconst createTable = (data, title) => {\r\n    const tableEl = document.createElement(\"table\");\r\n    const tbodyEl = document.createElement(\"tbody\");\r\n    tableEl.appendChild(tbodyEl);\r\n    tableEl.classList.add(\"editable-table\");\r\n\r\n    for (let i = 0; i < data.length; i++) {\r\n        let row = data[i];\r\n        const trEl = document.createElement(\"tr\");    \r\n        trEl.classList.add(\"relative-pos\");\r\n        trEl.appendChild(createAddRow(trEl));\r\n        for (let j = 0; j < row.length; j++) {\r\n            let value = row[j];\r\n            const tdEl = createEditableCell();\r\n            tdEl.textContent = value;\r\n            trEl.append(tdEl);\r\n        }\r\n        \r\n        trEl.append(createAddCol(trEl));\r\n        tbodyEl.appendChild(trEl);\r\n    }\r\n\r\n    const divContainer = document.createElement(\"div\");\r\n    const downloadBtn = document.createElement(\"button\");\r\n    downloadBtn.innerText = \"Download\";\r\n    downloadBtn.classList.add(\"download-btn\");\r\n    divContainer.appendChild(downloadBtn);\r\n    divContainer.appendChild(tableEl);\r\n    downloadBtn.addEventListener(\"click\", () => exportTableToXlsx(tableEl, title));\r\n\r\n    return divContainer;\r\n};\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/tableGenerator.js?");

/***/ }),

/***/ "./www/js/utils.js":
/*!*************************!*\
  !*** ./www/js/utils.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"getDateStringFromDatetime\": () => (/* binding */ getDateStringFromDatetime),\n/* harmony export */   \"getTimeFromDatetime\": () => (/* binding */ getTimeFromDatetime),\n/* harmony export */   \"getDatesBetweenDates\": () => (/* binding */ getDatesBetweenDates),\n/* harmony export */   \"getDayOfTheWeek\": () => (/* binding */ getDayOfTheWeek),\n/* harmony export */   \"isDateInstance\": () => (/* binding */ isDateInstance),\n/* harmony export */   \"isNotDateInstance\": () => (/* binding */ isNotDateInstance)\n/* harmony export */ });\nconst getDateStringFromDatetime = (datetime) => {\r\n    return datetime.toLocaleDateString();\r\n}\r\n\r\nconst getTimeFromDatetime = (datetime) => {\r\n    return datetime.toLocaleTimeString('en-us', { timeStyle: 'short' });\r\n}\r\n\r\nconst getDatesBetweenDates = (fromDate, toDate) => {\r\n    let dates = [];\r\n    while (fromDate <= toDate) {\r\n        dates.push(getDateStringFromDatetime(fromDate));\r\n        fromDate.setDate(fromDate.getDate() + 1);\r\n    }\r\n    return dates;\r\n};\r\n\r\nconst getDayOfTheWeek = (date) => {\r\n    return Intl.DateTimeFormat('en-US', { weekday: 'long' }).format(new Date(date));\r\n}\r\n\r\nconst isDateInstance = (param) => {\r\n    if (Array.isArray(param)) {\r\n        return param.every(d => d instanceof Date);\r\n    } else {\r\n        return param instanceof Date;\r\n    }\r\n};\r\n\r\nconst isNotDateInstance = (param) => {\r\n    if (Array.isArray(param)) {\r\n        return param.every(d => !(d instanceof Date));\r\n    } else {\r\n        return !(param instanceof Date);\r\n    }\r\n};\n\n//# sourceURL=webpack://com.dantuts.dtr/./www/js/utils.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./www/js/index.js");
/******/ 	
/******/ })()
;